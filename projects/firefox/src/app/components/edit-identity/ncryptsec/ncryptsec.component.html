<div class="header-pane">
  <lib-icon-button
    icon="chevron-left"
    (click)="navigateBack()"
  ></lib-icon-button>
  <span>Get ncryptsec</span>
</div>

<p class="description">
  Enter a password to encrypt your private key. The resulting ncryptsec can be
  used to securely backup or transfer your key.
</p>

<!-- PASSWORD INPUT -->
<div class="password-section">
  <label for="ncryptsecPasswordInput">Password</label>
  <div class="input-group sam-mt-h">
    <input
      id="ncryptsecPasswordInput"
      type="password"
      class="form-control"
      placeholder="Enter encryption password"
      [(ngModel)]="ncryptsecPassword"
      [disabled]="isGenerating"
      (keyup.enter)="generateNcryptsec()"
    />
  </div>
</div>

<button
  class="btn btn-primary generate-btn"
  type="button"
  (click)="generateNcryptsec()"
  [disabled]="!ncryptsecPassword || isGenerating"
>
  @if (isGenerating) {
    <span class="spinner-border spinner-border-sm" role="status"></span>
    Generating...
  } @else {
    Generate ncryptsec
  }
</button>

<!-- NCRYPTSEC OUTPUT -->
@if (ncryptsec) {
<div class="result-section">
  <!-- QR Code -->
  <div class="qr-container">
    <img [src]="ncryptsecQr" alt="ncryptsec QR code" class="qr-code" />
  </div>

  <!-- ncryptsec text -->
  <div class="ncryptsec-container">
    <input
      type="text"
      class="form-control ncryptsec-output"
      [value]="ncryptsec"
      readonly
      (click)="copyToClipboard(ncryptsec); toast.show('Copied to clipboard')"
      title="Click to copy"
    />
    <button
      class="btn btn-outline-secondary"
      type="button"
      (click)="copyToClipboard(ncryptsec); toast.show('Copied to clipboard')"
    >
      <i class="bi bi-copy"></i> Copy
    </button>
  </div>

  <p class="hint">Tap the text or button to copy to clipboard</p>
</div>
}

<lib-toast #toast [bottom]="16"></lib-toast>
